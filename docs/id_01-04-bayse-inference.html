<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.4 ベイズの定理を使ったクリック率の推論 | ウェブ最適化ではじめる機械学習 in R</title>
  <meta name="description" content="ウェブ最適化ではじめる機械学習 O’REIILYをRでやってみた，のまとめです" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="1.4 ベイズの定理を使ったクリック率の推論 | ウェブ最適化ではじめる機械学習 in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="ウェブ最適化ではじめる機械学習 O’REIILYをRでやってみた，のまとめです" />
  <meta name="github-repo" content="https://github.com/masayukeeeee/machine-learning-with-web-optimization-oreilly-in-r.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.4 ベイズの定理を使ったクリック率の推論 | ウェブ最適化ではじめる機械学習 in R" />
  
  <meta name="twitter:description" content="ウェブ最適化ではじめる機械学習 O’REIILYをRでやってみた，のまとめです" />
  

<meta name="author" content="Masayuki Sakai" />


<meta name="date" content="2023-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_01-03-additve-and-multiplication-theorem.html"/>
<link rel="next" href="id_01-05-implementation-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ウェブ最適化ではじめる機械学習 in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>概要</a></li>
<li class="chapter" data-level="1" data-path="id_01-intro.html"><a href="id_01-intro.html"><i class="fa fa-check"></i><b>1</b> A/Bテストから始めよう：ベイズ統計による仮説検定入門</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01-01-situation.html"><a href="id_01-01-situation.html"><i class="fa fa-check"></i><b>1.1</b> 状況設定</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="id_01-01-situation.html"><a href="id_01-01-situation.html#データ生成のプロセス"><i class="fa fa-check"></i><b>1.1.1</b> データ生成のプロセス</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="id_01-02-pdf-approximation.html"><a href="id_01-02-pdf-approximation.html"><i class="fa fa-check"></i><b>1.2</b> 離散化による確率密度関数の近似</a></li>
<li class="chapter" data-level="1.3" data-path="id_01-03-additve-and-multiplication-theorem.html"><a href="id_01-03-additve-and-multiplication-theorem.html"><i class="fa fa-check"></i><b>1.3</b> 加法定理・乗法定理</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="id_01-03-additve-and-multiplication-theorem.html"><a href="id_01-03-additve-and-multiplication-theorem.html#周辺化周辺分布"><i class="fa fa-check"></i><b>1.3.1</b> 周辺化・周辺分布</a></li>
<li class="chapter" data-level="1.3.2" data-path="id_01-03-additve-and-multiplication-theorem.html"><a href="id_01-03-additve-and-multiplication-theorem.html#連続値の場合"><i class="fa fa-check"></i><b>1.3.2</b> 連続値の場合</a></li>
<li class="chapter" data-level="1.3.3" data-path="id_01-03-additve-and-multiplication-theorem.html"><a href="id_01-03-additve-and-multiplication-theorem.html#ベイズの定理"><i class="fa fa-check"></i><b>1.3.3</b> ベイズの定理</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="id_01-04-bayse-inference.html"><a href="id_01-04-bayse-inference.html"><i class="fa fa-check"></i><b>1.4</b> ベイズの定理を使ったクリック率の推論</a></li>
<li class="chapter" data-level="1.5" data-path="id_01-05-implementation-in-r.html"><a href="id_01-05-implementation-in-r.html"><i class="fa fa-check"></i><b>1.5</b> Rでの実装</a></li>
<li class="chapter" data-level="1.6" data-path="id_01-06-bayse-inference-with-reports.html"><a href="id_01-06-bayse-inference-with-reports.html"><i class="fa fa-check"></i><b>1.6</b> レポートデータを用いた推論</a></li>
<li class="chapter" data-level="1.7" data-path="id_01-06-02-beta-distribution.html"><a href="id_01-06-02-beta-distribution.html"><i class="fa fa-check"></i><b>1.7</b> 別解:ベータ分布</a></li>
<li class="chapter" data-level="1.8" data-path="id_01-07-decision-making.html"><a href="id_01-07-decision-making.html"><i class="fa fa-check"></i><b>1.8</b> 事後分布から決断を下す</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="id_01-07-decision-making.html"><a href="id_01-07-decision-making.html#id_01-07-01-statistics"><i class="fa fa-check"></i><b>1.8.1</b> 要約統計量</a></li>
<li class="chapter" data-level="1.8.2" data-path="id_01-07-decision-making.html"><a href="id_01-07-decision-making.html#id_01-07-test-with-hdi"><i class="fa fa-check"></i><b>1.8.2</b> HDIをつかった仮設検定</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="id_01-08-introduce-new-random-variable.html"><a href="id_01-08-introduce-new-random-variable.html"><i class="fa fa-check"></i><b>1.9</b> 新たな確率変数を導入する</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02-00-00-inference-with-rstan.html"><a href="id_02-00-00-inference-with-rstan.html"><i class="fa fa-check"></i><b>2</b> RStanを使った推論</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02-02-00-review-score.html"><a href="id_02-02-00-review-score.html"><i class="fa fa-check"></i><b>2.1</b> 真のレビュースコア</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="id_02-02-00-review-score.html"><a href="id_02-02-00-review-score.html#ディリクレ分布による事前分布"><i class="fa fa-check"></i><b>2.1.1</b> ディリクレ分布による事前分布</a></li>
<li class="chapter" data-level="2.1.2" data-path="id_02-02-00-review-score.html"><a href="id_02-02-00-review-score.html#推論の実行"><i class="fa fa-check"></i><b>2.1.2</b> 推論の実行</a></li>
<li class="chapter" data-level="2.1.3" data-path="id_02-02-00-review-score.html"><a href="id_02-02-00-review-score.html#item-bについての推論"><i class="fa fa-check"></i><b>2.1.3</b> Item Bについての推論</a></li>
<li class="chapter" data-level="2.1.4" data-path="id_02-02-00-review-score.html"><a href="id_02-02-00-review-score.html#推定結果の比較"><i class="fa fa-check"></i><b>2.1.4</b> 推定結果の比較</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="id_02-03-00-visit-time.html"><a href="id_02-03-00-visit-time.html"><i class="fa fa-check"></i><b>2.2</b> 滞在時間をテストする</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="id_02-03-00-visit-time.html"><a href="id_02-03-00-visit-time.html#stanでの推定"><i class="fa fa-check"></i><b>2.2.1</b> Stanでの推定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03-00-00-test-with-combinations.html"><a href="id_03-00-00-test-with-combinations.html"><i class="fa fa-check"></i><b>3</b> 組み合わせのあるテスト</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03-01-00-sample-report.html"><a href="id_03-01-00-sample-report.html"><i class="fa fa-check"></i><b>3.1</b> サンプルレポート</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="id_03-01-00-sample-report.html"><a href="id_03-01-00-sample-report.html#id_03-01-01-simple-inference"><i class="fa fa-check"></i><b>3.1.1</b> シンプルなベイズ推論</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="id_03-02-00-modelling-1.html"><a href="id_03-02-00-modelling-1.html"><i class="fa fa-check"></i><b>3.2</b> モデリング1</a></li>
<li class="chapter" data-level="3.3" data-path="id_03-03-00-ダミー変数.html"><a href="id_03-03-00-ダミー変数.html"><i class="fa fa-check"></i><b>3.3</b> ダミー変数</a></li>
<li class="chapter" data-level="3.4" data-path="id_03-04-00-logistic-function.html"><a href="id_03-04-00-logistic-function.html"><i class="fa fa-check"></i><b>3.4</b> ロジスティック関数</a></li>
<li class="chapter" data-level="3.5" data-path="id_03-05-00-normal-distoribution.html"><a href="id_03-05-00-normal-distoribution.html"><i class="fa fa-check"></i><b>3.5</b> 正規分布</a></li>
<li class="chapter" data-level="3.6" data-path="id_03-06-00-modelling-2.html"><a href="id_03-06-00-modelling-2.html"><i class="fa fa-check"></i><b>3.6</b> モデリング2</a></li>
<li class="chapter" data-level="3.7" data-path="id_03-07-00-wrong-model.html"><a href="id_03-07-00-wrong-model.html"><i class="fa fa-check"></i><b>3.7</b> 間違ったモデル</a></li>
<li class="chapter" data-level="3.8" data-path="id_03-08-00-interaction.html"><a href="id_03-08-00-interaction.html"><i class="fa fa-check"></i><b>3.8</b> 交互作用</a></li>
<li class="chapter" data-level="3.9" data-path="id_03-09-00-summary.html"><a href="id_03-09-00-summary.html"><i class="fa fa-check"></i><b>3.9</b> まとめ</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="id_99_references.html"><a href="id_99_references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/masayukeeeee/machine-learning-with-web-optimization-oreilly-in-r.github.io" target="blank">GitHub repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ウェブ最適化ではじめる機械学習 in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_01-04-bayse-inference" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> ベイズの定理を使ったクリック率の推論<a href="id_01-04-bayse-inference.html#id_01-04-bayse-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>推論を実行する際に，最初にどのような事前分布を設定するかを考える必要がある．これは分析者次第となる．よく使われるものの一つとして無情報の事前分布といういみで一様分布を設定することがあり，ここではこれを採用する．</p>
<p><span class="math inline">\(\theta\)</span>はクリック率を表す確率変数であり，<span class="math inline">\(\theta \in [0,1]\)</span>なので<span class="math inline">\(U(0,1)\)</span>を設定しよう．
<span class="math display" id="eq:01-04-prior-dist-no-info">\[\begin{align}
  \tag{1.8}
  p(\theta) = \begin{cases}
    1 &amp; 0 \leq \theta \leq 1 \\
    0 &amp; \text{else}
  \end{cases}
\end{align}\]</span></p>
<p>さらにこの<span class="math inline">\(\theta\)</span>はクリック率を意味するので
<span class="math display" id="eq:01-04-r-with-theta">\[\begin{align}
  \tag{1.9}
  \text{Bernoulli}(\theta) = \theta^r(1-\theta)^{(1-r)}
\end{align}\]</span></p>
<p>推論を行うとき，パラメータが与えられた時の<span class="math inline">\(r\)</span>が発生する条件付き確率から，データが与えられた時に<span class="math inline">\(\theta\)</span>を推定することと読み替えることになる．
つまり<span class="math inline">\(p(\mathcal D|\theta)\)</span>ではなく<span class="math inline">\(p(\theta|\mathcal D)\)</span>を考える．これを尤度関数と呼び，一般には確率分布ではなくなる．</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="id_01-04-bayse-inference.html#cb3-1" aria-hidden="true" tabindex="-1"></a>scene <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-2"><a href="id_01-04-bayse-inference.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;xaxis&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;r&quot;</span>),</span>
<span id="cb3-3"><a href="id_01-04-bayse-inference.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;yaxis&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;theta&quot;</span>),</span>
<span id="cb3-4"><a href="id_01-04-bayse-inference.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;zaxis&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;p(r|theta)&quot;</span>)</span>
<span id="cb3-5"><a href="id_01-04-bayse-inference.html#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="id_01-04-bayse-inference.html#cb3-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb3-7"><a href="id_01-04-bayse-inference.html#cb3-7" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb3-8"><a href="id_01-04-bayse-inference.html#cb3-8" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span>n)</span>
<span id="cb3-9"><a href="id_01-04-bayse-inference.html#cb3-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(r,theta) <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="id_01-04-bayse-inference.html#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, <span class="cf">function</span>(e){</span>
<span id="cb3-11"><a href="id_01-04-bayse-inference.html#cb3-11" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> e[<span class="dv">2</span>]<span class="sc">^</span>{e[<span class="dv">1</span>]}<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>e[<span class="dv">2</span>])<span class="sc">^</span>{<span class="dv">1</span><span class="sc">-</span>e[<span class="dv">1</span>]}</span>
<span id="cb3-12"><a href="id_01-04-bayse-inference.html#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb3-13"><a href="id_01-04-bayse-inference.html#cb3-13" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a href="id_01-04-bayse-inference.html#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="at">nrow=</span>n, <span class="at">byrow=</span>T)</span>
<span id="cb3-15"><a href="id_01-04-bayse-inference.html#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span>r, <span class="at">y=</span>theta, <span class="at">z=</span>z,</span>
<span id="cb3-16"><a href="id_01-04-bayse-inference.html#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">hovertemplate =</span> <span class="st">&quot;r: %{x}&lt;br&gt;theta: %{y}&lt;br&gt;p(r|theta): %{z}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-17"><a href="id_01-04-bayse-inference.html#cb3-17" aria-hidden="true" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">add_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a href="id_01-04-bayse-inference.html#cb3-18" aria-hidden="true" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">scene=</span>scene)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:01-04-bernoulli-3d-plot"></span>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-69f5d66133edde1ccfae" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-69f5d66133edde1ccfae">{"x":{"visdat":{"1bd33664cc78":["function () ","plotlyVisDat"]},"cur_data":"1bd33664cc78","attrs":{"1bd33664cc78":{"x":[0,1],"y":[0,0.00334448160535117,0.00668896321070234,0.0100334448160535,0.0133779264214047,0.0167224080267559,0.020066889632107,0.0234113712374582,0.0267558528428094,0.0301003344481605,0.0334448160535117,0.0367892976588629,0.040133779264214,0.0434782608695652,0.0468227424749164,0.0501672240802676,0.0535117056856187,0.0568561872909699,0.0602006688963211,0.0635451505016722,0.0668896321070234,0.0702341137123746,0.0735785953177257,0.0769230769230769,0.0802675585284281,0.0836120401337793,0.0869565217391304,0.0903010033444816,0.0936454849498328,0.096989966555184,0.100334448160535,0.103678929765886,0.107023411371237,0.110367892976589,0.11371237458194,0.117056856187291,0.120401337792642,0.123745819397993,0.127090301003344,0.130434782608696,0.133779264214047,0.137123745819398,0.140468227424749,0.1438127090301,0.147157190635451,0.150501672240803,0.153846153846154,0.157190635451505,0.160535117056856,0.163879598662207,0.167224080267559,0.17056856187291,0.173913043478261,0.177257525083612,0.180602006688963,0.183946488294314,0.187290969899666,0.190635451505017,0.193979933110368,0.197324414715719,0.20066889632107,0.204013377926421,0.207357859531773,0.210702341137124,0.214046822742475,0.217391304347826,0.220735785953177,0.224080267558528,0.22742474916388,0.230769230769231,0.234113712374582,0.237458193979933,0.240802675585284,0.244147157190635,0.247491638795987,0.250836120401338,0.254180602006689,0.25752508361204,0.260869565217391,0.264214046822742,0.267558528428094,0.270903010033445,0.274247491638796,0.277591973244147,0.280936454849498,0.284280936454849,0.287625418060201,0.290969899665552,0.294314381270903,0.297658862876254,0.301003344481605,0.304347826086957,0.307692307692308,0.311036789297659,0.31438127090301,0.317725752508361,0.321070234113712,0.324414715719064,0.327759197324415,0.331103678929766,0.334448160535117,0.337792642140468,0.341137123745819,0.344481605351171,0.347826086956522,0.351170568561873,0.354515050167224,0.357859531772575,0.361204013377926,0.364548494983278,0.367892976588629,0.37123745819398,0.374581939799331,0.377926421404682,0.381270903010033,0.384615384615385,0.387959866220736,0.391304347826087,0.394648829431438,0.397993311036789,0.40133779264214,0.404682274247492,0.408026755852843,0.411371237458194,0.414715719063545,0.418060200668896,0.421404682274247,0.424749163879599,0.42809364548495,0.431438127090301,0.434782608695652,0.438127090301003,0.441471571906354,0.444816053511706,0.448160535117057,0.451505016722408,0.454849498327759,0.45819397993311,0.461538461538462,0.464882943143813,0.468227424749164,0.471571906354515,0.474916387959866,0.478260869565217,0.481605351170569,0.48494983277592,0.488294314381271,0.491638795986622,0.494983277591973,0.498327759197324,0.501672240802676,0.505016722408027,0.508361204013378,0.511705685618729,0.51505016722408,0.518394648829431,0.521739130434783,0.525083612040134,0.528428093645485,0.531772575250836,0.535117056856187,0.538461538461538,0.54180602006689,0.545150501672241,0.548494983277592,0.551839464882943,0.555183946488294,0.558528428093645,0.561872909698997,0.565217391304348,0.568561872909699,0.57190635451505,0.575250836120401,0.578595317725752,0.581939799331104,0.585284280936455,0.588628762541806,0.591973244147157,0.595317725752508,0.598662207357859,0.602006688963211,0.605351170568562,0.608695652173913,0.612040133779264,0.615384615384615,0.618729096989967,0.622073578595318,0.625418060200669,0.62876254180602,0.632107023411371,0.635451505016722,0.638795986622074,0.642140468227425,0.645484949832776,0.648829431438127,0.652173913043478,0.655518394648829,0.658862876254181,0.662207357859532,0.665551839464883,0.668896321070234,0.672240802675585,0.675585284280936,0.678929765886288,0.682274247491639,0.68561872909699,0.688963210702341,0.692307692307692,0.695652173913043,0.698996655518395,0.702341137123746,0.705685618729097,0.709030100334448,0.712374581939799,0.71571906354515,0.719063545150502,0.722408026755853,0.725752508361204,0.729096989966555,0.732441471571906,0.735785953177257,0.739130434782609,0.74247491638796,0.745819397993311,0.749163879598662,0.752508361204013,0.755852842809364,0.759197324414716,0.762541806020067,0.765886287625418,0.769230769230769,0.77257525083612,0.775919732441472,0.779264214046823,0.782608695652174,0.785953177257525,0.789297658862876,0.792642140468227,0.795986622073579,0.79933110367893,0.802675585284281,0.806020066889632,0.809364548494983,0.812709030100334,0.816053511705686,0.819397993311037,0.822742474916388,0.826086956521739,0.82943143812709,0.832775919732441,0.836120401337793,0.839464882943144,0.842809364548495,0.846153846153846,0.849498327759197,0.852842809364548,0.8561872909699,0.859531772575251,0.862876254180602,0.866220735785953,0.869565217391304,0.872909698996655,0.876254180602007,0.879598662207358,0.882943143812709,0.88628762541806,0.889632107023411,0.892976588628763,0.896321070234114,0.899665551839465,0.903010033444816,0.906354515050167,0.909698996655518,0.91304347826087,0.916387959866221,0.919732441471572,0.923076923076923,0.926421404682274,0.929765886287625,0.933110367892977,0.936454849498328,0.939799331103679,0.94314381270903,0.946488294314381,0.949832775919732,0.953177257525084,0.956521739130435,0.959866220735786,0.963210702341137,0.966555183946488,0.969899665551839,0.973244147157191,0.976588628762542,0.979933110367893,0.983277591973244,0.986622073578595,0.989966555183946,0.993311036789298,0.996655518394649,1],"z":[[1,0],[0.996655518394649,0.00334448160535117],[0.993311036789298,0.00668896321070234],[0.989966555183946,0.0100334448160535],[0.986622073578595,0.0133779264214047],[0.983277591973244,0.0167224080267559],[0.979933110367893,0.020066889632107],[0.976588628762542,0.0234113712374582],[0.973244147157191,0.0267558528428094],[0.969899665551839,0.0301003344481605],[0.966555183946488,0.0334448160535117],[0.963210702341137,0.0367892976588629],[0.959866220735786,0.040133779264214],[0.956521739130435,0.0434782608695652],[0.953177257525084,0.0468227424749164],[0.949832775919732,0.0501672240802676],[0.946488294314381,0.0535117056856187],[0.94314381270903,0.0568561872909699],[0.939799331103679,0.0602006688963211],[0.936454849498328,0.0635451505016722],[0.933110367892977,0.0668896321070234],[0.929765886287625,0.0702341137123746],[0.926421404682274,0.0735785953177257],[0.923076923076923,0.0769230769230769],[0.919732441471572,0.0802675585284281],[0.916387959866221,0.0836120401337793],[0.91304347826087,0.0869565217391304],[0.909698996655518,0.0903010033444816],[0.906354515050167,0.0936454849498328],[0.903010033444816,0.096989966555184],[0.899665551839465,0.100334448160535],[0.896321070234114,0.103678929765886],[0.892976588628763,0.107023411371237],[0.889632107023411,0.110367892976589],[0.88628762541806,0.11371237458194],[0.882943143812709,0.117056856187291],[0.879598662207358,0.120401337792642],[0.876254180602007,0.123745819397993],[0.872909698996655,0.127090301003344],[0.869565217391304,0.130434782608696],[0.866220735785953,0.133779264214047],[0.862876254180602,0.137123745819398],[0.859531772575251,0.140468227424749],[0.8561872909699,0.1438127090301],[0.852842809364548,0.147157190635451],[0.849498327759197,0.150501672240803],[0.846153846153846,0.153846153846154],[0.842809364548495,0.157190635451505],[0.839464882943144,0.160535117056856],[0.836120401337793,0.163879598662207],[0.832775919732441,0.167224080267559],[0.82943143812709,0.17056856187291],[0.826086956521739,0.173913043478261],[0.822742474916388,0.177257525083612],[0.819397993311037,0.180602006688963],[0.816053511705686,0.183946488294314],[0.812709030100334,0.187290969899666],[0.809364548494983,0.190635451505017],[0.806020066889632,0.193979933110368],[0.802675585284281,0.197324414715719],[0.79933110367893,0.20066889632107],[0.795986622073579,0.204013377926421],[0.792642140468227,0.207357859531773],[0.789297658862876,0.210702341137124],[0.785953177257525,0.214046822742475],[0.782608695652174,0.217391304347826],[0.779264214046823,0.220735785953177],[0.775919732441472,0.224080267558528],[0.77257525083612,0.22742474916388],[0.769230769230769,0.230769230769231],[0.765886287625418,0.234113712374582],[0.762541806020067,0.237458193979933],[0.759197324414716,0.240802675585284],[0.755852842809364,0.244147157190635],[0.752508361204013,0.247491638795987],[0.749163879598662,0.250836120401338],[0.745819397993311,0.254180602006689],[0.74247491638796,0.25752508361204],[0.739130434782609,0.260869565217391],[0.735785953177257,0.264214046822742],[0.732441471571906,0.267558528428094],[0.729096989966555,0.270903010033445],[0.725752508361204,0.274247491638796],[0.722408026755853,0.277591973244147],[0.719063545150502,0.280936454849498],[0.71571906354515,0.284280936454849],[0.712374581939799,0.287625418060201],[0.709030100334448,0.290969899665552],[0.705685618729097,0.294314381270903],[0.702341137123746,0.297658862876254],[0.698996655518395,0.301003344481605],[0.695652173913043,0.304347826086957],[0.692307692307692,0.307692307692308],[0.688963210702341,0.311036789297659],[0.68561872909699,0.31438127090301],[0.682274247491639,0.317725752508361],[0.678929765886288,0.321070234113712],[0.675585284280936,0.324414715719064],[0.672240802675585,0.327759197324415],[0.668896321070234,0.331103678929766],[0.665551839464883,0.334448160535117],[0.662207357859532,0.337792642140468],[0.658862876254181,0.341137123745819],[0.655518394648829,0.344481605351171],[0.652173913043478,0.347826086956522],[0.648829431438127,0.351170568561873],[0.645484949832776,0.354515050167224],[0.642140468227425,0.357859531772575],[0.638795986622074,0.361204013377926],[0.635451505016722,0.364548494983278],[0.632107023411371,0.367892976588629],[0.62876254180602,0.37123745819398],[0.625418060200669,0.374581939799331],[0.622073578595318,0.377926421404682],[0.618729096989967,0.381270903010033],[0.615384615384615,0.384615384615385],[0.612040133779264,0.387959866220736],[0.608695652173913,0.391304347826087],[0.605351170568562,0.394648829431438],[0.602006688963211,0.397993311036789],[0.59866220735786,0.40133779264214],[0.595317725752508,0.404682274247492],[0.591973244147157,0.408026755852843],[0.588628762541806,0.411371237458194],[0.585284280936455,0.414715719063545],[0.581939799331104,0.418060200668896],[0.578595317725753,0.421404682274247],[0.575250836120401,0.424749163879599],[0.57190635451505,0.42809364548495],[0.568561872909699,0.431438127090301],[0.565217391304348,0.434782608695652],[0.561872909698997,0.438127090301003],[0.558528428093646,0.441471571906354],[0.555183946488294,0.444816053511706],[0.551839464882943,0.448160535117057],[0.548494983277592,0.451505016722408],[0.545150501672241,0.454849498327759],[0.54180602006689,0.45819397993311],[0.538461538461539,0.461538461538462],[0.535117056856187,0.464882943143813],[0.531772575250836,0.468227424749164],[0.528428093645485,0.471571906354515],[0.525083612040134,0.474916387959866],[0.521739130434783,0.478260869565217],[0.518394648829431,0.481605351170569],[0.51505016722408,0.48494983277592],[0.511705685618729,0.488294314381271],[0.508361204013378,0.491638795986622],[0.505016722408027,0.494983277591973],[0.501672240802676,0.498327759197324],[0.498327759197324,0.501672240802676],[0.494983277591973,0.505016722408027],[0.491638795986622,0.508361204013378],[0.488294314381271,0.511705685618729],[0.48494983277592,0.51505016722408],[0.481605351170569,0.518394648829431],[0.478260869565217,0.521739130434783],[0.474916387959866,0.525083612040134],[0.471571906354515,0.528428093645485],[0.468227424749164,0.531772575250836],[0.464882943143813,0.535117056856187],[0.461538461538462,0.538461538461538],[0.45819397993311,0.54180602006689],[0.454849498327759,0.545150501672241],[0.451505016722408,0.548494983277592],[0.448160535117057,0.551839464882943],[0.444816053511706,0.555183946488294],[0.441471571906355,0.558528428093645],[0.438127090301003,0.561872909698997],[0.434782608695652,0.565217391304348],[0.431438127090301,0.568561872909699],[0.42809364548495,0.57190635451505],[0.424749163879599,0.575250836120401],[0.421404682274248,0.578595317725752],[0.418060200668896,0.581939799331104],[0.414715719063545,0.585284280936455],[0.411371237458194,0.588628762541806],[0.408026755852843,0.591973244147157],[0.404682274247492,0.595317725752508],[0.401337792642141,0.598662207357859],[0.397993311036789,0.602006688963211],[0.394648829431438,0.605351170568562],[0.391304347826087,0.608695652173913],[0.387959866220736,0.612040133779264],[0.384615384615385,0.615384615384615],[0.381270903010033,0.618729096989967],[0.377926421404682,0.622073578595318],[0.374581939799331,0.625418060200669],[0.37123745819398,0.62876254180602],[0.367892976588629,0.632107023411371],[0.364548494983278,0.635451505016722],[0.361204013377926,0.638795986622074],[0.357859531772575,0.642140468227425],[0.354515050167224,0.645484949832776],[0.351170568561873,0.648829431438127],[0.347826086956522,0.652173913043478],[0.344481605351171,0.655518394648829],[0.341137123745819,0.658862876254181],[0.337792642140468,0.662207357859532],[0.334448160535117,0.665551839464883],[0.331103678929766,0.668896321070234],[0.327759197324415,0.672240802675585],[0.324414715719064,0.675585284280936],[0.321070234113712,0.678929765886288],[0.317725752508361,0.682274247491639],[0.31438127090301,0.68561872909699],[0.311036789297659,0.688963210702341],[0.307692307692308,0.692307692307692],[0.304347826086957,0.695652173913043],[0.301003344481605,0.698996655518395],[0.297658862876254,0.702341137123746],[0.294314381270903,0.705685618729097],[0.290969899665552,0.709030100334448],[0.287625418060201,0.712374581939799],[0.28428093645485,0.71571906354515],[0.280936454849498,0.719063545150502],[0.277591973244147,0.722408026755853],[0.274247491638796,0.725752508361204],[0.270903010033445,0.729096989966555],[0.267558528428094,0.732441471571906],[0.264214046822743,0.735785953177257],[0.260869565217391,0.739130434782609],[0.25752508361204,0.74247491638796],[0.254180602006689,0.745819397993311],[0.250836120401338,0.749163879598662],[0.247491638795987,0.752508361204013],[0.244147157190636,0.755852842809364],[0.240802675585284,0.759197324414716],[0.237458193979933,0.762541806020067],[0.234113712374582,0.765886287625418],[0.230769230769231,0.769230769230769],[0.22742474916388,0.77257525083612],[0.224080267558528,0.775919732441472],[0.220735785953177,0.779264214046823],[0.217391304347826,0.782608695652174],[0.214046822742475,0.785953177257525],[0.210702341137124,0.789297658862876],[0.207357859531773,0.792642140468227],[0.204013377926421,0.795986622073579],[0.20066889632107,0.79933110367893],[0.197324414715719,0.802675585284281],[0.193979933110368,0.806020066889632],[0.190635451505017,0.809364548494983],[0.187290969899666,0.812709030100334],[0.183946488294314,0.816053511705686],[0.180602006688963,0.819397993311037],[0.177257525083612,0.822742474916388],[0.173913043478261,0.826086956521739],[0.17056856187291,0.82943143812709],[0.167224080267559,0.832775919732441],[0.163879598662207,0.836120401337793],[0.160535117056856,0.839464882943144],[0.157190635451505,0.842809364548495],[0.153846153846154,0.846153846153846],[0.150501672240803,0.849498327759197],[0.147157190635452,0.852842809364548],[0.1438127090301,0.8561872909699],[0.140468227424749,0.859531772575251],[0.137123745819398,0.862876254180602],[0.133779264214047,0.866220735785953],[0.130434782608696,0.869565217391304],[0.127090301003345,0.872909698996655],[0.123745819397993,0.876254180602007],[0.120401337792642,0.879598662207358],[0.117056856187291,0.882943143812709],[0.11371237458194,0.88628762541806],[0.110367892976589,0.889632107023411],[0.107023411371237,0.892976588628763],[0.103678929765886,0.896321070234114],[0.100334448160535,0.899665551839465],[0.096989966555184,0.903010033444816],[0.0936454849498328,0.906354515050167],[0.0903010033444817,0.909698996655518],[0.0869565217391305,0.91304347826087],[0.0836120401337793,0.916387959866221],[0.0802675585284282,0.919732441471572],[0.076923076923077,0.923076923076923],[0.0735785953177258,0.926421404682274],[0.0702341137123746,0.929765886287625],[0.0668896321070235,0.933110367892977],[0.0635451505016723,0.936454849498328],[0.0602006688963211,0.939799331103679],[0.0568561872909699,0.94314381270903],[0.0535117056856187,0.946488294314381],[0.0501672240802675,0.949832775919732],[0.0468227424749164,0.953177257525084],[0.0434782608695652,0.956521739130435],[0.040133779264214,0.959866220735786],[0.0367892976588629,0.963210702341137],[0.0334448160535117,0.966555183946488],[0.0301003344481605,0.969899665551839],[0.0267558528428093,0.973244147157191],[0.0234113712374582,0.976588628762542],[0.020066889632107,0.979933110367893],[0.0167224080267558,0.983277591973244],[0.0133779264214047,0.986622073578595],[0.0100334448160535,0.989966555183946],[0.00668896321070234,0.993311036789298],[0.00334448160535117,0.996655518394649],[0,1]],"hovertemplate":"r: %{x}<br>theta: %{y}<br>p(r|theta): %{z}","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"r"},"yaxis":{"title":"theta"},"zaxis":{"title":"p(r|theta)"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0,1],"y":[0,0.00334448160535117,0.00668896321070234,0.0100334448160535,0.0133779264214047,0.0167224080267559,0.020066889632107,0.0234113712374582,0.0267558528428094,0.0301003344481605,0.0334448160535117,0.0367892976588629,0.040133779264214,0.0434782608695652,0.0468227424749164,0.0501672240802676,0.0535117056856187,0.0568561872909699,0.0602006688963211,0.0635451505016722,0.0668896321070234,0.0702341137123746,0.0735785953177257,0.0769230769230769,0.0802675585284281,0.0836120401337793,0.0869565217391304,0.0903010033444816,0.0936454849498328,0.096989966555184,0.100334448160535,0.103678929765886,0.107023411371237,0.110367892976589,0.11371237458194,0.117056856187291,0.120401337792642,0.123745819397993,0.127090301003344,0.130434782608696,0.133779264214047,0.137123745819398,0.140468227424749,0.1438127090301,0.147157190635451,0.150501672240803,0.153846153846154,0.157190635451505,0.160535117056856,0.163879598662207,0.167224080267559,0.17056856187291,0.173913043478261,0.177257525083612,0.180602006688963,0.183946488294314,0.187290969899666,0.190635451505017,0.193979933110368,0.197324414715719,0.20066889632107,0.204013377926421,0.207357859531773,0.210702341137124,0.214046822742475,0.217391304347826,0.220735785953177,0.224080267558528,0.22742474916388,0.230769230769231,0.234113712374582,0.237458193979933,0.240802675585284,0.244147157190635,0.247491638795987,0.250836120401338,0.254180602006689,0.25752508361204,0.260869565217391,0.264214046822742,0.267558528428094,0.270903010033445,0.274247491638796,0.277591973244147,0.280936454849498,0.284280936454849,0.287625418060201,0.290969899665552,0.294314381270903,0.297658862876254,0.301003344481605,0.304347826086957,0.307692307692308,0.311036789297659,0.31438127090301,0.317725752508361,0.321070234113712,0.324414715719064,0.327759197324415,0.331103678929766,0.334448160535117,0.337792642140468,0.341137123745819,0.344481605351171,0.347826086956522,0.351170568561873,0.354515050167224,0.357859531772575,0.361204013377926,0.364548494983278,0.367892976588629,0.37123745819398,0.374581939799331,0.377926421404682,0.381270903010033,0.384615384615385,0.387959866220736,0.391304347826087,0.394648829431438,0.397993311036789,0.40133779264214,0.404682274247492,0.408026755852843,0.411371237458194,0.414715719063545,0.418060200668896,0.421404682274247,0.424749163879599,0.42809364548495,0.431438127090301,0.434782608695652,0.438127090301003,0.441471571906354,0.444816053511706,0.448160535117057,0.451505016722408,0.454849498327759,0.45819397993311,0.461538461538462,0.464882943143813,0.468227424749164,0.471571906354515,0.474916387959866,0.478260869565217,0.481605351170569,0.48494983277592,0.488294314381271,0.491638795986622,0.494983277591973,0.498327759197324,0.501672240802676,0.505016722408027,0.508361204013378,0.511705685618729,0.51505016722408,0.518394648829431,0.521739130434783,0.525083612040134,0.528428093645485,0.531772575250836,0.535117056856187,0.538461538461538,0.54180602006689,0.545150501672241,0.548494983277592,0.551839464882943,0.555183946488294,0.558528428093645,0.561872909698997,0.565217391304348,0.568561872909699,0.57190635451505,0.575250836120401,0.578595317725752,0.581939799331104,0.585284280936455,0.588628762541806,0.591973244147157,0.595317725752508,0.598662207357859,0.602006688963211,0.605351170568562,0.608695652173913,0.612040133779264,0.615384615384615,0.618729096989967,0.622073578595318,0.625418060200669,0.62876254180602,0.632107023411371,0.635451505016722,0.638795986622074,0.642140468227425,0.645484949832776,0.648829431438127,0.652173913043478,0.655518394648829,0.658862876254181,0.662207357859532,0.665551839464883,0.668896321070234,0.672240802675585,0.675585284280936,0.678929765886288,0.682274247491639,0.68561872909699,0.688963210702341,0.692307692307692,0.695652173913043,0.698996655518395,0.702341137123746,0.705685618729097,0.709030100334448,0.712374581939799,0.71571906354515,0.719063545150502,0.722408026755853,0.725752508361204,0.729096989966555,0.732441471571906,0.735785953177257,0.739130434782609,0.74247491638796,0.745819397993311,0.749163879598662,0.752508361204013,0.755852842809364,0.759197324414716,0.762541806020067,0.765886287625418,0.769230769230769,0.77257525083612,0.775919732441472,0.779264214046823,0.782608695652174,0.785953177257525,0.789297658862876,0.792642140468227,0.795986622073579,0.79933110367893,0.802675585284281,0.806020066889632,0.809364548494983,0.812709030100334,0.816053511705686,0.819397993311037,0.822742474916388,0.826086956521739,0.82943143812709,0.832775919732441,0.836120401337793,0.839464882943144,0.842809364548495,0.846153846153846,0.849498327759197,0.852842809364548,0.8561872909699,0.859531772575251,0.862876254180602,0.866220735785953,0.869565217391304,0.872909698996655,0.876254180602007,0.879598662207358,0.882943143812709,0.88628762541806,0.889632107023411,0.892976588628763,0.896321070234114,0.899665551839465,0.903010033444816,0.906354515050167,0.909698996655518,0.91304347826087,0.916387959866221,0.919732441471572,0.923076923076923,0.926421404682274,0.929765886287625,0.933110367892977,0.936454849498328,0.939799331103679,0.94314381270903,0.946488294314381,0.949832775919732,0.953177257525084,0.956521739130435,0.959866220735786,0.963210702341137,0.966555183946488,0.969899665551839,0.973244147157191,0.976588628762542,0.979933110367893,0.983277591973244,0.986622073578595,0.989966555183946,0.993311036789298,0.996655518394649,1],"z":[[1,0],[0.996655518394649,0.00334448160535117],[0.993311036789298,0.00668896321070234],[0.989966555183946,0.0100334448160535],[0.986622073578595,0.0133779264214047],[0.983277591973244,0.0167224080267559],[0.979933110367893,0.020066889632107],[0.976588628762542,0.0234113712374582],[0.973244147157191,0.0267558528428094],[0.969899665551839,0.0301003344481605],[0.966555183946488,0.0334448160535117],[0.963210702341137,0.0367892976588629],[0.959866220735786,0.040133779264214],[0.956521739130435,0.0434782608695652],[0.953177257525084,0.0468227424749164],[0.949832775919732,0.0501672240802676],[0.946488294314381,0.0535117056856187],[0.94314381270903,0.0568561872909699],[0.939799331103679,0.0602006688963211],[0.936454849498328,0.0635451505016722],[0.933110367892977,0.0668896321070234],[0.929765886287625,0.0702341137123746],[0.926421404682274,0.0735785953177257],[0.923076923076923,0.0769230769230769],[0.919732441471572,0.0802675585284281],[0.916387959866221,0.0836120401337793],[0.91304347826087,0.0869565217391304],[0.909698996655518,0.0903010033444816],[0.906354515050167,0.0936454849498328],[0.903010033444816,0.096989966555184],[0.899665551839465,0.100334448160535],[0.896321070234114,0.103678929765886],[0.892976588628763,0.107023411371237],[0.889632107023411,0.110367892976589],[0.88628762541806,0.11371237458194],[0.882943143812709,0.117056856187291],[0.879598662207358,0.120401337792642],[0.876254180602007,0.123745819397993],[0.872909698996655,0.127090301003344],[0.869565217391304,0.130434782608696],[0.866220735785953,0.133779264214047],[0.862876254180602,0.137123745819398],[0.859531772575251,0.140468227424749],[0.8561872909699,0.1438127090301],[0.852842809364548,0.147157190635451],[0.849498327759197,0.150501672240803],[0.846153846153846,0.153846153846154],[0.842809364548495,0.157190635451505],[0.839464882943144,0.160535117056856],[0.836120401337793,0.163879598662207],[0.832775919732441,0.167224080267559],[0.82943143812709,0.17056856187291],[0.826086956521739,0.173913043478261],[0.822742474916388,0.177257525083612],[0.819397993311037,0.180602006688963],[0.816053511705686,0.183946488294314],[0.812709030100334,0.187290969899666],[0.809364548494983,0.190635451505017],[0.806020066889632,0.193979933110368],[0.802675585284281,0.197324414715719],[0.79933110367893,0.20066889632107],[0.795986622073579,0.204013377926421],[0.792642140468227,0.207357859531773],[0.789297658862876,0.210702341137124],[0.785953177257525,0.214046822742475],[0.782608695652174,0.217391304347826],[0.779264214046823,0.220735785953177],[0.775919732441472,0.224080267558528],[0.77257525083612,0.22742474916388],[0.769230769230769,0.230769230769231],[0.765886287625418,0.234113712374582],[0.762541806020067,0.237458193979933],[0.759197324414716,0.240802675585284],[0.755852842809364,0.244147157190635],[0.752508361204013,0.247491638795987],[0.749163879598662,0.250836120401338],[0.745819397993311,0.254180602006689],[0.74247491638796,0.25752508361204],[0.739130434782609,0.260869565217391],[0.735785953177257,0.264214046822742],[0.732441471571906,0.267558528428094],[0.729096989966555,0.270903010033445],[0.725752508361204,0.274247491638796],[0.722408026755853,0.277591973244147],[0.719063545150502,0.280936454849498],[0.71571906354515,0.284280936454849],[0.712374581939799,0.287625418060201],[0.709030100334448,0.290969899665552],[0.705685618729097,0.294314381270903],[0.702341137123746,0.297658862876254],[0.698996655518395,0.301003344481605],[0.695652173913043,0.304347826086957],[0.692307692307692,0.307692307692308],[0.688963210702341,0.311036789297659],[0.68561872909699,0.31438127090301],[0.682274247491639,0.317725752508361],[0.678929765886288,0.321070234113712],[0.675585284280936,0.324414715719064],[0.672240802675585,0.327759197324415],[0.668896321070234,0.331103678929766],[0.665551839464883,0.334448160535117],[0.662207357859532,0.337792642140468],[0.658862876254181,0.341137123745819],[0.655518394648829,0.344481605351171],[0.652173913043478,0.347826086956522],[0.648829431438127,0.351170568561873],[0.645484949832776,0.354515050167224],[0.642140468227425,0.357859531772575],[0.638795986622074,0.361204013377926],[0.635451505016722,0.364548494983278],[0.632107023411371,0.367892976588629],[0.62876254180602,0.37123745819398],[0.625418060200669,0.374581939799331],[0.622073578595318,0.377926421404682],[0.618729096989967,0.381270903010033],[0.615384615384615,0.384615384615385],[0.612040133779264,0.387959866220736],[0.608695652173913,0.391304347826087],[0.605351170568562,0.394648829431438],[0.602006688963211,0.397993311036789],[0.59866220735786,0.40133779264214],[0.595317725752508,0.404682274247492],[0.591973244147157,0.408026755852843],[0.588628762541806,0.411371237458194],[0.585284280936455,0.414715719063545],[0.581939799331104,0.418060200668896],[0.578595317725753,0.421404682274247],[0.575250836120401,0.424749163879599],[0.57190635451505,0.42809364548495],[0.568561872909699,0.431438127090301],[0.565217391304348,0.434782608695652],[0.561872909698997,0.438127090301003],[0.558528428093646,0.441471571906354],[0.555183946488294,0.444816053511706],[0.551839464882943,0.448160535117057],[0.548494983277592,0.451505016722408],[0.545150501672241,0.454849498327759],[0.54180602006689,0.45819397993311],[0.538461538461539,0.461538461538462],[0.535117056856187,0.464882943143813],[0.531772575250836,0.468227424749164],[0.528428093645485,0.471571906354515],[0.525083612040134,0.474916387959866],[0.521739130434783,0.478260869565217],[0.518394648829431,0.481605351170569],[0.51505016722408,0.48494983277592],[0.511705685618729,0.488294314381271],[0.508361204013378,0.491638795986622],[0.505016722408027,0.494983277591973],[0.501672240802676,0.498327759197324],[0.498327759197324,0.501672240802676],[0.494983277591973,0.505016722408027],[0.491638795986622,0.508361204013378],[0.488294314381271,0.511705685618729],[0.48494983277592,0.51505016722408],[0.481605351170569,0.518394648829431],[0.478260869565217,0.521739130434783],[0.474916387959866,0.525083612040134],[0.471571906354515,0.528428093645485],[0.468227424749164,0.531772575250836],[0.464882943143813,0.535117056856187],[0.461538461538462,0.538461538461538],[0.45819397993311,0.54180602006689],[0.454849498327759,0.545150501672241],[0.451505016722408,0.548494983277592],[0.448160535117057,0.551839464882943],[0.444816053511706,0.555183946488294],[0.441471571906355,0.558528428093645],[0.438127090301003,0.561872909698997],[0.434782608695652,0.565217391304348],[0.431438127090301,0.568561872909699],[0.42809364548495,0.57190635451505],[0.424749163879599,0.575250836120401],[0.421404682274248,0.578595317725752],[0.418060200668896,0.581939799331104],[0.414715719063545,0.585284280936455],[0.411371237458194,0.588628762541806],[0.408026755852843,0.591973244147157],[0.404682274247492,0.595317725752508],[0.401337792642141,0.598662207357859],[0.397993311036789,0.602006688963211],[0.394648829431438,0.605351170568562],[0.391304347826087,0.608695652173913],[0.387959866220736,0.612040133779264],[0.384615384615385,0.615384615384615],[0.381270903010033,0.618729096989967],[0.377926421404682,0.622073578595318],[0.374581939799331,0.625418060200669],[0.37123745819398,0.62876254180602],[0.367892976588629,0.632107023411371],[0.364548494983278,0.635451505016722],[0.361204013377926,0.638795986622074],[0.357859531772575,0.642140468227425],[0.354515050167224,0.645484949832776],[0.351170568561873,0.648829431438127],[0.347826086956522,0.652173913043478],[0.344481605351171,0.655518394648829],[0.341137123745819,0.658862876254181],[0.337792642140468,0.662207357859532],[0.334448160535117,0.665551839464883],[0.331103678929766,0.668896321070234],[0.327759197324415,0.672240802675585],[0.324414715719064,0.675585284280936],[0.321070234113712,0.678929765886288],[0.317725752508361,0.682274247491639],[0.31438127090301,0.68561872909699],[0.311036789297659,0.688963210702341],[0.307692307692308,0.692307692307692],[0.304347826086957,0.695652173913043],[0.301003344481605,0.698996655518395],[0.297658862876254,0.702341137123746],[0.294314381270903,0.705685618729097],[0.290969899665552,0.709030100334448],[0.287625418060201,0.712374581939799],[0.28428093645485,0.71571906354515],[0.280936454849498,0.719063545150502],[0.277591973244147,0.722408026755853],[0.274247491638796,0.725752508361204],[0.270903010033445,0.729096989966555],[0.267558528428094,0.732441471571906],[0.264214046822743,0.735785953177257],[0.260869565217391,0.739130434782609],[0.25752508361204,0.74247491638796],[0.254180602006689,0.745819397993311],[0.250836120401338,0.749163879598662],[0.247491638795987,0.752508361204013],[0.244147157190636,0.755852842809364],[0.240802675585284,0.759197324414716],[0.237458193979933,0.762541806020067],[0.234113712374582,0.765886287625418],[0.230769230769231,0.769230769230769],[0.22742474916388,0.77257525083612],[0.224080267558528,0.775919732441472],[0.220735785953177,0.779264214046823],[0.217391304347826,0.782608695652174],[0.214046822742475,0.785953177257525],[0.210702341137124,0.789297658862876],[0.207357859531773,0.792642140468227],[0.204013377926421,0.795986622073579],[0.20066889632107,0.79933110367893],[0.197324414715719,0.802675585284281],[0.193979933110368,0.806020066889632],[0.190635451505017,0.809364548494983],[0.187290969899666,0.812709030100334],[0.183946488294314,0.816053511705686],[0.180602006688963,0.819397993311037],[0.177257525083612,0.822742474916388],[0.173913043478261,0.826086956521739],[0.17056856187291,0.82943143812709],[0.167224080267559,0.832775919732441],[0.163879598662207,0.836120401337793],[0.160535117056856,0.839464882943144],[0.157190635451505,0.842809364548495],[0.153846153846154,0.846153846153846],[0.150501672240803,0.849498327759197],[0.147157190635452,0.852842809364548],[0.1438127090301,0.8561872909699],[0.140468227424749,0.859531772575251],[0.137123745819398,0.862876254180602],[0.133779264214047,0.866220735785953],[0.130434782608696,0.869565217391304],[0.127090301003345,0.872909698996655],[0.123745819397993,0.876254180602007],[0.120401337792642,0.879598662207358],[0.117056856187291,0.882943143812709],[0.11371237458194,0.88628762541806],[0.110367892976589,0.889632107023411],[0.107023411371237,0.892976588628763],[0.103678929765886,0.896321070234114],[0.100334448160535,0.899665551839465],[0.096989966555184,0.903010033444816],[0.0936454849498328,0.906354515050167],[0.0903010033444817,0.909698996655518],[0.0869565217391305,0.91304347826087],[0.0836120401337793,0.916387959866221],[0.0802675585284282,0.919732441471572],[0.076923076923077,0.923076923076923],[0.0735785953177258,0.926421404682274],[0.0702341137123746,0.929765886287625],[0.0668896321070235,0.933110367892977],[0.0635451505016723,0.936454849498328],[0.0602006688963211,0.939799331103679],[0.0568561872909699,0.94314381270903],[0.0535117056856187,0.946488294314381],[0.0501672240802675,0.949832775919732],[0.0468227424749164,0.953177257525084],[0.0434782608695652,0.956521739130435],[0.040133779264214,0.959866220735786],[0.0367892976588629,0.963210702341137],[0.0334448160535117,0.966555183946488],[0.0301003344481605,0.969899665551839],[0.0267558528428093,0.973244147157191],[0.0234113712374582,0.976588628762542],[0.020066889632107,0.979933110367893],[0.0167224080267558,0.983277591973244],[0.0133779264214047,0.986622073578595],[0.0100334448160535,0.989966555183946],[0.00668896321070234,0.993311036789298],[0.00334448160535117,0.996655518394649],[0,1]],"hovertemplate":"r: %{x}<br>theta: %{y}<br>p(r|theta): %{z}","type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 1.3: ベルヌーイ分布の3D表現
</p>
</div>
<p><span class="math inline">\(p(r|\theta)\)</span>を尤度関数とみなす，つまり<span class="math inline">\(r\)</span>を固定した時の<span class="math inline">\(\theta\)</span>の関数と考えた時，<span class="math inline">\(r=1\)</span>であれば
<span class="math display">\[\begin{align}
  \int_{0}^{1} \theta^{r} (1-\theta)^{1-r} d\theta &amp;= \begin{cases}
    \int_{0}^{1} \theta d\theta, &amp; r=1 \\
    \int_{0}^{1} (1-\theta) d\theta, &amp; r=0
  \end{cases} \\
  &amp;= \dfrac12
\end{align}\]</span>
となる．全積分が1ではないため，確率分布ではないことがわかる．</p>
<p>さてこれらの尤度関数と事前分布を@ref{eq:bayse-inference-with-propto}式に代入すると，<span class="math inline">\(\theta \in [0,1]\)</span>の範囲において考えれば<span class="math inline">\(p(\theta)=1\)</span>なので
<span class="math display">\[\begin{align}
  p(\theta | r) &amp;= \propto p(r | \theta) p(\theta) \\
  &amp;= \theta^r(1-\theta)^{1-r}
\end{align}\]</span>
となる．
先ほどの議論と同様にこの関数は確率分布ではないため，事後分布とするために正規化定数<span class="math inline">\(p(r)\)</span>で除する必要がある．
<span class="math display">\[\begin{align}
  p(r) &amp;= \int_{-\infty}^{\infty} p(r|\theta) p(\theta) d \theta \\
  &amp;= \int_0^1 \theta^r (1-\theta)^{(1-r)} d \theta \\
  &amp;=
  \begin{cases}
    \displaystyle \int_0^1 (1-\theta) d \theta, &amp; r=0 \\
    \displaystyle \int_0^1 \theta d \theta, &amp; r=1
  \end{cases} \\
  &amp;= \dfrac12  
\end{align}\]</span>
であるので，結局事後分布は
<span class="math display">\[\begin{align}
  p(\theta | r) &amp;= \dfrac{p(r|\theta)p(\theta)}{p(r)} \\
  &amp;= 2 \theta^r (1-\theta)^{(1-r)}
\end{align}\]</span>
と求められる．これらを図示すれば</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="id_01-04-bayse-inference.html#cb4-1" aria-hidden="true" tabindex="-1"></a>att_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;r=1&quot;</span>, <span class="st">&quot;r=0&quot;</span>)</span>
<span id="cb4-2"><a href="id_01-04-bayse-inference.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(att_labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-3"><a href="id_01-04-bayse-inference.html#cb4-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="id_01-04-bayse-inference.html#cb4-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">300</span>)</span>
<span id="cb4-5"><a href="id_01-04-bayse-inference.html#cb4-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(r, theta) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="id_01-04-bayse-inference.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v =</span> <span class="dv">2</span><span class="sc">*</span>theta<span class="sc">^</span>r <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>theta)<span class="sc">^</span>{<span class="dv">1</span><span class="sc">-</span>r})</span>
<span id="cb4-7"><a href="id_01-04-bayse-inference.html#cb4-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>theta, <span class="at">y=</span>v,<span class="at">group=</span>r)) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="id_01-04-bayse-inference.html#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="id_01-04-bayse-inference.html#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>r, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">r=</span>att_labs))</span>
<span id="cb4-10"><a href="id_01-04-bayse-inference.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:01-04-posterior-dist"></span>
<img src="_main_files/figure-html/01-04-posterior-dist-1.png" alt="ベイズ推論によって得られた事後分布" width="672" />
<p class="caption">
Figure 1.4: ベイズ推論によって得られた事後分布
</p>
</div>
<p>以上は一回のデータ観測におけるベイズ推論であったが実際にはいくつかのデータが得られているはずで，その分推論を繰り返すことでデータ<span class="math inline">\(\mathcal D\)</span>が観測された元での事後分布を得ることができる．ただしこの時，各データは独立であるという過程が置かれている．</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_01-03-additve-and-multiplication-theorem.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_01-05-implementation-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["docs/webops-and-ml-in-r.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
